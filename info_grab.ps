# Used to collect information from computer

# ======== PLEASE READ =========
# Execute this command in PowerShell beforehand
# if PowerShell will not let you run the script:
# Set-ExecutionPolicy Unrestricted

#Text files will be made wherever the program is ran

#Send computer name and system information to text
$env:username >> name.txt
$env:userdomain >> name.txt
$env:computername >> name.txt
systeminfo >> name.txt

#Send current Task Manager information to text
tasklist /svc > task.txt

#Show currently running services (sent to text)
net start > serv.txt

#Send arp results to text
arp -a > arp.txt

#Send netstat results to text
netstat -a >netstat.txt

#Send ipconfig results to text
ipconfig /all >ipconfig.txt

#Send route results to text
route print >route.txt

#Send everything in the \etc folder to text
cat C:\Windows\System32\drivers\etc\* > etc.txt

#Show what's in the current user's \Temp folder
dir C:\Users\$env:username\AppData\Local\Temp > tempdir.txt

#Export Registry
REG EXPORT HKCR hkcr.txt
REG EXPORT HKCU hkcu.txt
REG EXPORT HKLM hklm.txt
REG EXPORT HKCC hkcc.txt

#Export log files from Event Viewer
wevtutil epl Application app.evtx
wevtutil epl System sys.evtx
wevtutil epl Setup set.evtx
wevtutil epl Security sec.evtx		#Must Run as Administrator to work
wevtutil epl "Forwarded Events" fe.evtx	#Will fail if log is disabled
